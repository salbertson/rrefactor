<% title "Posts" %>

<% if current_user %>
  <p><%= link_to "Post code", new_post_path %></p>
<% else %>
  <p><%= link_to "Login to post code", login_path %></p>
<% end %>

<table>
  <tr>
    <th>Name</th>
    <th>Description</th>
    <th>Code</th>
  </tr>
  <% for post in @posts %>
    <tr>
      <td><%=h post.name %></td>
      <td><%=h post.description %></td>
      <td><%= simple_format(post.code) %></td>
      <td><%= link_to "Show", post %></td>
      <% if current_user == post.user %>
        <td><%= link_to "Edit", edit_post_path(post) %></td>
        <td><%= link_to "Delete", post, :confirm => 'Are you sure?', :method => :delete %></td>
      <% else %>
        <% if current_user %>
          <td><%= link_to "Refactor", new_refactoring_path(:post_id => post) %></td>
        <% else %>
          <td><%= link_to "Login to Refactor", login_path %></td>
        <% end %>
      <% end %>
    </tr>
  <% end %>
</table>
